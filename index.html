<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home - Health Buddy</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <nav>
        <h1>üè• Health Buddy</h1>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="sevice.html">Services</a></li>
            <li><a href="about.html">About</a></li>
            <li><a href="contact.html">Contact</a></li>
            <li><a href="#" id="authLink">Login</a></li>
        </ul>
    </nav>

    <div class="hero">
        <h2>Your Health, Our Priority</h2>
        <p>Experience personalized healthcare services with Health Buddy. We're committed to your wellness journey.</p>
        <a href="#" id="getStartedBtn" class="btn btn-primary">Get Started</a>
    </div>

    <section>
        <h2>Welcome to Health Buddy</h2>
        <p id="welcomeMessage">We provide comprehensive healthcare services to keep you and your family healthy.</p>
        
        <div class="services-grid">
            <div class="service-card">
                <h3>üë®‚Äç‚öïÔ∏è General Checkups</h3>
                <p>Regular health checkups and preventive care to keep you fit and healthy throughout the year.</p>
            </div>
            <div class="service-card">
                <h3>üë∂ Pediatrics</h3>
                <p>Comprehensive care for your children by our experienced pediatric specialists.</p>
            </div>
            <div class="service-card">
                <h3>ü¶∑ Dental Care</h3>
                <p>From cleaning to cosmetic dentistry, we ensure your perfect smile and oral health.</p>
            </div>
            <div class="service-card">
                <h3>‚ù§Ô∏è Cardiology</h3>
                <p>Advanced heart care with experienced cardiologists and state-of-the-art diagnostics.</p>
            </div>
        </div>
    </section>

    <footer>
        <p>¬© 2025 Health Buddy | Committed to Your Wellness</p>
    </footer>

    <script src="api.js"></script>
    <script src="auth.js"></script>
    <script>
        // Check if user is logged in
        window.addEventListener('DOMContentLoaded', async function() {
            const authLink = document.getElementById('authLink');
            const getStartedBtn = document.getElementById('getStartedBtn');
            const welcomeMessage = document.getElementById('welcomeMessage');

            // Try to verify user with backend
            let currentUser = getCurrentUser();
            
            if (currentUser || getToken()) {
                try {
                    const verifiedUser = await getCurrentUserAsync();
                    if (verifiedUser) {
                        currentUser = verifiedUser;
                        authLink.textContent = 'Logout';
                        authLink.href = '#';
                        authLink.onclick = function(e) {
                            e.preventDefault();
                            logoutUser();
                            window.location.href = 'login.html';
                        };
                        welcomeMessage.textContent = `Welcome back, ${currentUser.username}! We provide comprehensive healthcare services to keep you and your family healthy.`;
                        
                        // User is logged in - "Get Started" goes to buddy.html
                        getStartedBtn.href = 'buddy.html';
                        getStartedBtn.onclick = null;
                    } else {
                        // Token invalid, redirect to login
                        authLink.textContent = 'Login';
                        authLink.href = 'login.html';
                        
                        // User not logged in - "Get Started" goes to login
                        getStartedBtn.href = '#';
                        getStartedBtn.onclick = function(e) {
                            e.preventDefault();
                            window.location.href = 'login.html';
                        };
                    }
                } catch (error) {
                    console.error('Auth verification error:', error);
                    // Show login link if verification fails
                    authLink.textContent = 'Login';
                    authLink.href = 'login.html';
                    
                    // User not logged in - "Get Started" goes to login
                    getStartedBtn.href = '#';
                    getStartedBtn.onclick = function(e) {
                        e.preventDefault();
                        window.location.href = 'login.html';
                    };
                }
            } else {
                // No user or token, show login link
                authLink.textContent = 'Login';
                authLink.href = 'login.html';
                
                // User not logged in - "Get Started" goes to login
                getStartedBtn.href = '#';
                getStartedBtn.onclick = function(e) {
                    e.preventDefault();
                    window.location.href = 'login.html';
                };
            }
        });
    </script>
</body>
</html>